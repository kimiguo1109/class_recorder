# Requirements: 课堂录音转录与 AI 学习助手

## 1. 项目概述

### 1.1 产品愿景
创建一个实时课堂录音转录系统，能够捕获音频、实时转录、**自动翻译成英文**，并生成多种 AI 驱动的学习材料（笔记、闪卡、测验、思维导图等）。

### 1.2 目标用户
- 大学生和高中生
- 需要记录讲座内容的学习者
- 需要多语言支持的国际学生
- 希望通过 AI 生成学习材料的用户

### 1.3 核心价值
- 实时音频转录，无需手动记笔记
- **支持任何语言输入，自动翻译成英文**
- AI 生成的学习材料（闪卡、测验、思维导图）
- 富文本笔记编辑功能
- 完整的录音和转录文本保存与下载

## 2. 功能需求（按优先级排序）

### 2.1 Phase 1: 核心转录 MVP

#### FR-1.1 音频录制与实时转录
**作为** 学生  
**我想要** 录制课堂音频并实时看到转录文本  
**以便** 我可以专注听讲而不用手动记笔记

**验收标准：**
- 用户可以点击"开始录音"按钮开始录制
- 音频通过 WebSocket 实时流式传输到后端
- 转录文本实时显示在左侧面板，带有时间戳
- 音频格式：16-bit PCM, 16kHz, mono
- 转录延迟 < 2 秒

#### FR-1.2 实时音频波形可视化
**作为** 用户  
**我想要** 看到实时音频波形图  
**以便** 我可以确认麦克风正在工作

**验收标准：**
- 底部控制条显示实时音频波形
- 波形反映当前音频输入强度
- 使用 Canvas 或 SVG 渲染

#### FR-1.3 双栏布局 UI
**作为** 用户  
**我想要** 清晰的界面布局  
**以便** 我可以同时查看转录文本和其他功能

**验收标准：**
- 左侧面板：转录文本区域（可滚动，虚拟化列表）
- 右侧面板：标签页结构（笔记、闪卡、测验等）
- 底部：录音控制条（开始/暂停/停止、波形图、时间显示）

### 2.2 Phase 2: 多语言实时翻译（核心功能）

#### FR-2.1 自动语言检测与翻译
**作为** 国际学生  
**我想要** 系统自动检测任何语言并实时翻译成英文  
**以便** 我可以理解不同语言的课程内容

**验收标准：**
- 系统自动检测输入音频的语言（中文、日语、韩语、西班牙语等）
- 实时将转录文本翻译成英文
- 左侧面板显示"原文"和"英文翻译"两种模式切换按钮
- 翻译延迟 < 3 秒
- 支持的语言：中文（简体/繁体）、日语、韩语、西班牙语、法语、德语、俄语等主流语言

#### FR-2.2 原文与翻译对照显示
**作为** 用户  
**我想要** 可以切换查看原文或翻译  
**以便** 我可以对比学习

**验收标准：**
- 切换按钮：["原文" | "英文翻译" | "双语对照"]
- 双语对照模式下，每个转录块显示原文和翻译
- 点击任意文本块可高亮对应的翻译块

### 2.3 Phase 3: 笔记功能

#### FR-3.1 富文本笔记编辑
**作为** 用户  
**我想要** 在听课时添加自己的笔记  
**以便** 我可以补充和整理知识点

**验收标准：**
- 右侧"Lecture Notes"标签页包含富文本编辑器
- 支持功能：加粗、斜体、下划线、标题、列表、代码块
- 笔记自动保存（本地存储）
- 可以导出笔记为 Markdown 或 PDF

#### FR-3.2 录音和转录保存与下载
**作为** 用户  
**我想要** 下载录音文件和转录文本  
**以便** 我可以离线查看或分享

**验收标准：**
- 停止录音后显示"下载录音"和"下载转录文本"按钮
- 录音格式：WebM 或 WAV
- 转录文本格式：TXT 或 JSON（包含时间戳和翻译）
- 文件名包含录制日期和时间

### 2.4 Phase 4: 高级 AI 学习工具

#### FR-4.1 AI 生成闪卡
**作为** 学生  
**我想要** 基于转录内容自动生成闪卡  
**以便** 我可以复习关键概念

**验收标准：**
- 用户点击"生成闪卡"按钮
- AI 分析转录文本，提取关键概念
- 生成 10-20 张闪卡（问题 + 答案）
- 闪卡可编辑、删除、导出（Anki 格式）

#### FR-4.2 AI 生成测验
**作为** 学生  
**我想要** 基于课程内容自动生成测验  
**以便** 我可以测试自己的理解程度

**验收标准：**
- 生成 5-10 道多选题
- 每题包含 4 个选项和正确答案
- 用户可以答题并查看得分
- 显示错误答案的解析

#### FR-4.3 AI 生成思维导图
**作为** 学生  
**我想要** 将课程内容可视化为思维导图  
**以便** 我可以更好地理解知识结构

**验收标准：**
- AI 提取主题和子主题
- 生成结构化的思维导图数据
- 使用 React Flow 或 D3.js 渲染思维导图
- 可以导出为 PNG 或 SVG

### 2.5 Phase 5: 聊天机器人

#### FR-5.1 基于转录内容的问答
**作为** 学生  
**我想要** 向 AI 提问关于课程内容的问题  
**以便** 我可以深入理解难点

**验收标准：**
- "Chat"标签页包含聊天界面
- AI 基于转录文本回答问题
- 支持多轮对话
- 显示聊天历史

### 2.6 Phase 6: 健壮性与优化

#### FR-6.1 WebSocket 连接管理
**作为** 用户  
**我想要** 系统在网络不稳定时自动重连  
**以便** 我不会丢失录音数据

**验收标准：**
- WebSocket 心跳机制（每 30 秒）
- 断线自动重连（最多 5 次）
- 客户端音频缓冲（最多 10 秒）
- 显示连接状态指示器

#### FR-6.2 长时程录音测试
**作为** 开发者  
**我想要** 确保系统可以稳定运行 45 分钟  
**以便** 用户可以录制完整的课程

**验收标准：**
- 完成 45 分钟连续录音测试
- 无内存泄漏
- 转录准确率 > 90%
- CPU 使用率 < 30%

## 3. 非功能需求

### 3.1 性能要求
- 转录延迟：< 2 秒
- 翻译延迟：< 3 秒
- UI 响应时间：< 100ms
- 支持 45 分钟以上连续录音

### 3.2 技术栈
- **后端：** Python 3.11+, FastAPI, WebSocket, Google Gemini Live API
- **前端：** React 18+, TypeScript, TailwindCSS, WebSocket
- **AI API：** Gemini 2.5 Flash（实时转录和翻译）, Gemini 2.0 Flash（内容生成）

### 3.3 浏览器兼容性
- Chrome 100+
- Firefox 100+
- Safari 15+
- Edge 100+

### 3.4 安全性
- HTTPS 连接（生产环境）
- API Key 环境变量管理
- 音频数据不存储在服务器（仅流式处理）

## 4. 约束条件

### 4.1 技术约束
- 使用 Gemini Live API（免费配额限制）
- 音频格式必须为 16-bit PCM, 16kHz
- WebSocket 连接限制：每个会话最长 60 分钟

### 4.2 业务约束
- MVP 阶段不包含用户认证
- 不存储用户数据到数据库
- 仅支持单用户使用（无多用户并发）

## 5. 验收标准总结

项目成功标准：
1. ✅ 用户可以录制音频并实时查看转录文本
2. ✅ **支持任何语言自动翻译成英文**
3. ✅ 可以下载录音文件和转录文本
4. ✅ 可以编辑和导出笔记
5. ✅ AI 生成闪卡、测验、思维导图功能正常
6. ✅ 系统可以稳定运行 45 分钟以上
7. ✅ 在主流浏览器上正常工作

## 6. 里程碑

| 阶段 | 交付内容 | 预计时间 |
|------|---------|---------|
| Phase 1 | 核心转录 MVP | 2 天 |
| Phase 2 | 多语言翻译功能 | 1 天 |
| Phase 3 | 笔记功能与保存下载 | 1 天 |
| Phase 4 | AI 学习工具 | 2 天 |
| Phase 5 | 聊天机器人 | 1 天 |
| Phase 6 | 测试与优化 | 1 天 |
| **总计** | **完整功能系统** | **8 天** |

